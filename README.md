# 51单片机上的小型操作系统

## 1.主要功能
处理机管理，支持多进程并发。

## 2.实现原理
1.采用时间片轮转法，进行处理机调度。设置定时器2每隔 t ms就进行一次中断，在定时器2的中断处理函数中，进行处理机调度和上下文切换。
2.上下文切换原理。每个进程都保留着一个栈空间和一个栈指针。当中断时，单片机的中断隐指令会将下一条指令地址弹入`SP`寄存器所指的栈中，同时生成中断向量。在中断服务程序中，首先保存当前`SP`到当前进程的栈指针中，接着寻找下一个就绪进程，最后加载下一个进程的栈指针到`SP`中。而下一个就绪进程的栈中存放着上次切换时的指令地址，通过`ret`指令，`PC`中将会加载该指令。